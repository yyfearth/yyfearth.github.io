define("lib/fullcalendar",["lib/jquery-ui"],function(){!function(t,e){function n(e){t.extend(!0,Ce,e)}function r(n,r,u){function c(t){ae?g()&&(T(),_(t)):d()}function d(){oe=r.theme?"ui":"fc",n.addClass("fc"),n.addClass(r.isRTL?"fc-rtl":"fc-ltr"),r.theme&&n.addClass("ui-widget"),ae=t("<div class='fc-content' style='position:relative'/>").prependTo(n),ne=new a(ee,r),re=ne.render(),re&&n.prepend(re),y(r.defaultView),r.handleWindowResize&&t(window).resize(S),m()||h()}function h(){setTimeout(function(){!ie.start&&m()&&C()},0)}function v(){ie&&(te("viewDestroy",ie,ie,ie.element),ie.triggerEventDestroy()),t(window).unbind("resize",S),ne.destroy(),ae.remove(),n.removeClass("fc fc-rtl ui-widget")}function g(){return n.is(":visible")}function m(){return t("body").is(":visible")}function y(t){ie&&t==ie.name||D(t)}function D(e){ve++,ie&&(te("viewDestroy",ie,ie,ie.element),I(),ie.triggerEventDestroy(),U(),ie.element.remove(),ne.deactivateButton(ie.name)),ne.activateButton(e),ie=new Te[e](t("<div class='fc-view fc-view-"+e+"' style='position:relative'/>").appendTo(ae),ee),C(),Z(),ve--}function C(t){(!ie.start||t||ie.start>pe||pe>=ie.end)&&g()&&_(t)}function _(t){ve++,ie.start&&(te("viewDestroy",ie,ie,ie.element),I(),F()),U(),ie.render(pe,t||0),E(),Z(),(ie.afterRender||O)(),L(),P(),te("viewRender",ie,ie,ie.element),ie.trigger("viewDisplay",fe),ve--,z()}function M(){g()&&(I(),F(),T(),E(),H())}function T(){le=r.contentHeight?r.contentHeight:r.height?r.height-(re?re.height():0)-R(ae):Math.round(ae.width()/Math.max(r.aspectRatio,.5))}function E(){le===e&&T(),ve++,ie.setHeight(le),ie.setWidth(ae.width()),ve--,se=n.outerWidth()}function S(){if(!ve)if(ie.start){var t=++he;setTimeout(function(){t==he&&!ve&&g()&&se!=(se=n.outerWidth())&&(ve++,M(),ie.trigger("windowResize",fe),ve--)},200)}else h()}function k(){F(),N()}function x(t){F(),H(t)}function H(t){g()&&(ie.setEventData(ge),ie.renderEvents(ge,t),ie.trigger("eventAfterAllRender"))}function F(){ie.triggerEventDestroy(),ie.clearEvents(),ie.clearEventData()}function z(){!r.lazyFetching||ce(ie.visStart,ie.visEnd)?N():H()}function N(){de(ie.visStart,ie.visEnd)}function A(t){ge=t,H()}function W(t){x(t)}function L(){ne.updateTitle(ie.title)}function P(){var t=new Date;t>=ie.start&&ie.end>t?ne.disableButton("today"):ne.enableButton("today")}function j(t,n,r){ie.select(t,n,r===e?!0:r)}function I(){ie&&ie.unselect()}function q(){C(-1)}function $(){C(1)}function V(){i(pe,-1),C()}function B(){i(pe,1),C()}function Y(){pe=new Date,C()}function J(t,e,n){t instanceof Date?pe=f(t):p(pe,t,e,n),C()}function X(t,n,r){t!==e&&i(pe,t),n!==e&&s(pe,n),r!==e&&l(pe,r),C()}function K(){return f(pe)}function U(){ae.css({width:"100%",height:ae.height(),overflow:"hidden"})}function Z(){ae.css({width:"",height:"",overflow:""})}function G(){return ie}function Q(t,n){return n===e?r[t]:(("height"==t||"contentHeight"==t||"aspectRatio"==t)&&(r[t]=n,M()),e)}function te(t,n){return r[t]?r[t].apply(n||fe,Array.prototype.slice.call(arguments,2)):e}var ee=this;ee.options=r,ee.render=c,ee.destroy=v,ee.refetchEvents=k,ee.reportEvents=A,ee.reportEventChange=W,ee.rerenderEvents=x,ee.changeView=y,ee.select=j,ee.unselect=I,ee.prev=q,ee.next=$,ee.prevYear=V,ee.nextYear=B,ee.today=Y,ee.gotoDate=J,ee.incrementDate=X,ee.formatDate=function(t,e){return w(t,e,r)},ee.formatDates=function(t,e,n){return b(t,e,n,r)},ee.getDate=K,ee.getView=G,ee.option=Q,ee.trigger=te,o.call(ee,r,u);var ne,re,ae,oe,ie,se,le,ue,ce=ee.isFetchNeeded,de=ee.fetchEvents,fe=n[0],he=0,ve=0,pe=new Date,ge=[];p(pe,r.year,r.month,r.date),r.droppable&&t(document).bind("dragstart",function(e,n){var a=e.target,o=t(a);if(!o.parents(".fc").length){var i=r.dropAccept;(t.isFunction(i)?i.call(a,o):o.is(i))&&(ue=a,ie.dragStart(ue,e,n))}}).bind("dragstop",function(t,e){ue&&(ie.dragStop(ue,t,e),ue=null)})}function a(n,r){function a(){h=r.theme?"ui":"fc";var n=r.header;return n?v=t("<table class='fc-header' style='width:100%'/>").append(t("<tr/>").append(i("left")).append(i("center")).append(i("right"))):e}function o(){v.remove()}function i(e){var a=t("<td class='fc-header-"+e+"'/>"),o=r.header[e];return o&&t.each(o.split(" "),function(e){e>0&&a.append("<span class='fc-header-space'/>");var o;t.each(this.split(","),function(e,i){if("title"==i)a.append("<span class='fc-header-title'><h2>&nbsp;</h2></span>"),o&&o.addClass(h+"-corner-right"),o=null;else{var s;if(n[i]?s=n[i]:Te[i]&&(s=function(){c.removeClass(h+"-state-hover"),n.changeView(i)}),s){var l=r.theme?P(r.buttonIcons,i):null,u=P(r.buttonText,i),c=t("<span class='fc-button fc-button-"+i+" "+h+"-state-default'>"+(l?"<span class='fc-icon-wrap'><span class='ui-icon ui-icon-"+l+"'/></span>":u)+"</span>").click(function(){c.hasClass(h+"-state-disabled")||s()}).mousedown(function(){c.not("."+h+"-state-active").not("."+h+"-state-disabled").addClass(h+"-state-down")}).mouseup(function(){c.removeClass(h+"-state-down")}).hover(function(){c.not("."+h+"-state-active").not("."+h+"-state-disabled").addClass(h+"-state-hover")},function(){c.removeClass(h+"-state-hover").removeClass(h+"-state-down")}).appendTo(a);I(c),o||c.addClass(h+"-corner-left"),o=c}}}),o&&o.addClass(h+"-corner-right")}),a}function s(t){v.find("h2").html(t)}function l(t){v.find("span.fc-button-"+t).addClass(h+"-state-active")}function u(t){v.find("span.fc-button-"+t).removeClass(h+"-state-active")}function c(t){v.find("span.fc-button-"+t).addClass(h+"-state-disabled")}function d(t){v.find("span.fc-button-"+t).removeClass(h+"-state-disabled")}var f=this;f.render=a,f.destroy=o,f.updateTitle=s,f.activateButton=l,f.deactivateButton=u,f.disableButton=c,f.enableButton=d;var h,v=t([])}function o(n,r){function a(t,e){return!M||M>t||e>T}function o(t,e){M=t,T=e,N=[];var n=++R,r=H.length;F=r;for(var a=0;r>a;a++)i(H[a],n)}function i(e,r){s(e,function(a){if(r==R){if(a){n.eventDataTransform&&(a=t.map(a,n.eventDataTransform)),e.eventDataTransform&&(a=t.map(a,e.eventDataTransform));for(var o=0;a.length>o;o++)a[o].source=e,w(a[o]);N=N.concat(a)}F--,F||k(N)}})}function s(r,a){var o,i,l=Me.sourceFetchers;for(o=0;l.length>o;o++){if(i=l[o](r,M,T,a),i===!0)return;if("object"==typeof i)return s(i,a),e}var u=r.events;if(u)t.isFunction(u)?(m(),u(f(M),f(T),function(t){a(t),y()})):t.isArray(u)?a(u):a();else{var c=r.url;if(c){var d,h=r.success,v=r.error,p=r.complete;d=t.isFunction(r.data)?r.data():r.data;var g=t.extend({},d||{}),w=B(r.startParam,n.startParam),b=B(r.endParam,n.endParam);w&&(g[w]=Math.round(+M/1e3)),b&&(g[b]=Math.round(+T/1e3)),m(),t.ajax(t.extend({},Ee,r,{data:g,success:function(e){e=e||[];var n=V(h,this,arguments);t.isArray(n)&&(e=n),a(e)},error:function(){V(v,this,arguments),a()},complete:function(){V(p,this,arguments),y()}}))}else a()}}function l(t){t=u(t),t&&(F++,i(t,R))}function u(n){return t.isFunction(n)||t.isArray(n)?n={events:n}:"string"==typeof n&&(n={url:n}),"object"==typeof n?(b(n),H.push(n),n):e}function c(e){H=t.grep(H,function(t){return!D(t,e)}),N=t.grep(N,function(t){return!D(t.source,e)}),k(N)}function d(t){var e,n,r=N.length,a=S().defaultEventEnd,o=t.start-t._start,i=t.end?t.end-(t._end||a(t)):0;for(e=0;r>e;e++)n=N[e],n._id==t._id&&n!=t&&(n.start=new Date(+n.start+o),n.end=t.end?new Date(n.end?+n.end+i:+a(n)+i):null,n.title=t.title,n.url=t.url,n.allDay=t.allDay,n.className=t.className,n.editable=t.editable,n.color=t.color,n.backgroundColor=t.backgroundColor,n.borderColor=t.borderColor,n.textColor=t.textColor,w(n));w(t),k(N)}function h(t,e){w(t),t.source||(e&&(x.events.push(t),t.source=x),N.push(t)),k(N)}function v(e){if(e){if(!t.isFunction(e)){var n=e+"";e=function(t){return t._id==n}}N=t.grep(N,e,!0);for(var r=0;H.length>r;r++)t.isArray(H[r].events)&&(H[r].events=t.grep(H[r].events,e,!0))}else{N=[];for(var r=0;H.length>r;r++)t.isArray(H[r].events)&&(H[r].events=[])}k(N)}function p(e){return t.isFunction(e)?t.grep(N,e):e?(e+="",t.grep(N,function(t){return t._id==e})):N}function m(){z++||E("loading",null,!0,S())}function y(){--z||E("loading",null,!1,S())}function w(t){var r=t.source||{},a=B(r.ignoreTimezone,n.ignoreTimezone);t._id=t._id||(t.id===e?"_fc"+Se++:t.id+""),t.date&&(t.start||(t.start=t.date),delete t.date),t._start=f(t.start=g(t.start,a)),t.end=g(t.end,a),t.end&&t.end<=t.start&&(t.end=null),t._end=t.end?f(t.end):null,t.allDay===e&&(t.allDay=B(r.allDayDefault,n.allDayDefault)),t.className?"string"==typeof t.className&&(t.className=t.className.split(/\s+/)):t.className=[]}function b(t){t.className?"string"==typeof t.className&&(t.className=t.className.split(/\s+/)):t.className=[];for(var e=Me.sourceNormalizers,n=0;e.length>n;n++)e[n](t)}function D(t,e){return t&&e&&C(t)==C(e)}function C(t){return("object"==typeof t?t.events||t.url:"")||t}var _=this;_.isFetchNeeded=a,_.fetchEvents=o,_.addEventSource=l,_.removeEventSource=c,_.updateEvent=d,_.renderEvent=h,_.removeEvents=v,_.clientEvents=p,_.normalizeEvent=w;for(var M,T,E=_.trigger,S=_.getView,k=_.reportEvents,x={events:[]},H=[x],R=0,F=0,z=0,N=[],O=0;r.length>O;O++)u(r[O])}function i(t,e,n){return t.setFullYear(t.getFullYear()+e),n||d(t),t}function s(t,e,n){if(+t){var r=t.getMonth()+e,a=f(t);for(a.setDate(1),a.setMonth(r),t.setMonth(r),n||d(t);t.getMonth()!=a.getMonth();)t.setDate(t.getDate()+(a>t?1:-1))}return t}function l(t,e,n){if(+t){var r=t.getDate()+e,a=f(t);a.setHours(9),a.setDate(r),t.setDate(r),n||d(t),u(t,a)}return t}function u(t,e){if(+t)for(;t.getDate()!=e.getDate();)t.setTime(+t+(e>t?1:-1)*He)}function c(t,e){return t.setMinutes(t.getMinutes()+e),t}function d(t){return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}function f(t,e){return e?d(new Date(+t)):new Date(+t)}function h(){var t,e=0;do t=new Date(1970,e++,1);while(t.getHours());return t}function v(t,e){return Math.round((f(t,!0)-f(e,!0))/xe)}function p(t,n,r,a){n!==e&&n!=t.getFullYear()&&(t.setDate(1),t.setMonth(0),t.setFullYear(n)),r!==e&&r!=t.getMonth()&&(t.setDate(1),t.setMonth(r)),a!==e&&t.setDate(a)}function g(t,n){return"object"==typeof t?t:"number"==typeof t?new Date(1e3*t):"string"==typeof t?t.match(/^\d+(\.\d+)?$/)?new Date(1e3*parseFloat(t)):(n===e&&(n=!0),m(t,n)||(t?new Date(t):null)):null}function m(t,e){var n=t.match(/^([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/);if(!n)return null;var r=new Date(n[1],0,1);if(e||!n[13]){var a=new Date(n[1],0,1,9,0);n[3]&&(r.setMonth(n[3]-1),a.setMonth(n[3]-1)),n[5]&&(r.setDate(n[5]),a.setDate(n[5])),u(r,a),n[7]&&r.setHours(n[7]),n[8]&&r.setMinutes(n[8]),n[10]&&r.setSeconds(n[10]),n[12]&&r.setMilliseconds(1e3*Number("0."+n[12])),u(r,a)}else if(r.setUTCFullYear(n[1],n[3]?n[3]-1:0,n[5]||1),r.setUTCHours(n[7]||0,n[8]||0,n[10]||0,n[12]?1e3*Number("0."+n[12]):0),n[14]){var o=60*Number(n[16])+(n[18]?Number(n[18]):0);o*="-"==n[15]?1:-1,r=new Date(+r+6e4*o)}return r}function y(t){if("number"==typeof t)return 60*t;if("object"==typeof t)return 60*t.getHours()+t.getMinutes();var e=t.match(/(\d+)(?::(\d+))?\s*(\w+)?/);if(e){var n=parseInt(e[1],10);return e[3]&&(n%=12,"p"==e[3].toLowerCase().charAt(0)&&(n+=12)),60*n+(e[2]?parseInt(e[2],10):0)}}function w(t,e,n){return b(t,null,e,n)}function b(t,e,n,r){r=r||Ce;var a,o,i,s,l=t,u=e,c=n.length,d="";for(a=0;c>a;a++)if(o=n.charAt(a),"'"==o){for(i=a+1;c>i;i++)if("'"==n.charAt(i)){l&&(d+=i==a+1?"'":n.substring(a+1,i),a=i);break}}else if("("==o){for(i=a+1;c>i;i++)if(")"==n.charAt(i)){var f=w(l,n.substring(a+1,i),r);parseInt(f.replace(/\D/,""),10)&&(d+=f),a=i;break}}else if("["==o){for(i=a+1;c>i;i++)if("]"==n.charAt(i)){var h=n.substring(a+1,i),f=w(l,h,r);f!=w(u,h,r)&&(d+=f),a=i;break}}else if("{"==o)l=e,u=t;else if("}"==o)l=t,u=e;else{for(i=c;i>a;i--)if(s=Fe[n.substring(a,i)]){l&&(d+=s(l,r)),a=i-1;break}i==a&&l&&(d+=o)}return d}function D(t){var e,n=new Date(t.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),e=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((e-n)/864e5)/7)+1}function C(t){return t.end?_(t.end,t.allDay):l(f(t.start),1)}function _(t,e){return t=f(t),e||t.getHours()||t.getMinutes()?l(t,1):d(t)}function M(n,r,a){n.unbind("mouseover").mouseover(function(n){for(var o,i,s,l=n.target;l!=this;)o=l,l=l.parentNode;(i=o._fci)!==e&&(o._fci=e,s=r[i],a(s.event,s.element,s),t(n.target).trigger(n)),n.stopPropagation()})}function T(e,n,r){for(var a,o=0;e.length>o;o++)a=t(e[o]),a.width(Math.max(0,n-S(a,r)))}function E(e,n,r){for(var a,o=0;e.length>o;o++)a=t(e[o]),a.height(Math.max(0,n-R(a,r)))}function S(t,e){return k(t)+H(t)+(e?x(t):0)}function k(e){return(parseFloat(t.css(e[0],"paddingLeft",!0))||0)+(parseFloat(t.css(e[0],"paddingRight",!0))||0)}function x(e){return(parseFloat(t.css(e[0],"marginLeft",!0))||0)+(parseFloat(t.css(e[0],"marginRight",!0))||0)}function H(e){return(parseFloat(t.css(e[0],"borderLeftWidth",!0))||0)+(parseFloat(t.css(e[0],"borderRightWidth",!0))||0)}function R(t,e){return F(t)+N(t)+(e?z(t):0)}function F(e){return(parseFloat(t.css(e[0],"paddingTop",!0))||0)+(parseFloat(t.css(e[0],"paddingBottom",!0))||0)}function z(e){return(parseFloat(t.css(e[0],"marginTop",!0))||0)+(parseFloat(t.css(e[0],"marginBottom",!0))||0)}function N(e){return(parseFloat(t.css(e[0],"borderTopWidth",!0))||0)+(parseFloat(t.css(e[0],"borderBottomWidth",!0))||0)}function O(){}function A(t,e){return t-e}function W(t){return Math.max.apply(Math,t)}function L(t){return(10>t?"0":"")+t}function P(t,n){if(t[n]!==e)return t[n];for(var r,a=n.split(/(?=[A-Z])/),o=a.length-1;o>=0;o--)if(r=t[a[o].toLowerCase()],r!==e)return r;return t[""]}function j(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")}function I(t){t.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function q(t){t.children().removeClass("fc-first fc-last").filter(":first-child").addClass("fc-first").end().filter(":last-child").addClass("fc-last")}function $(t,e){var n=t.source||{},r=t.color,a=n.color,o=e("eventColor"),i=t.backgroundColor||r||n.backgroundColor||a||e("eventBackgroundColor")||o,s=t.borderColor||r||n.borderColor||a||e("eventBorderColor")||o,l=t.textColor||n.textColor||e("eventTextColor"),u=[];return i&&u.push("background-color:"+i),s&&u.push("border-color:"+s),l&&u.push("color:"+l),u.join(";")}function V(e,n,r){if(t.isFunction(e)&&(e=[e]),e){var a,o;for(a=0;e.length>a;a++)o=e[a].apply(n,r)||o;return o}}function B(){for(var t=0;arguments.length>t;t++)if(arguments[t]!==e)return arguments[t]}function Y(t,e){function n(t,e){e&&(s(t,e),t.setDate(1));var n=a("firstDay"),d=f(t,!0);d.setDate(1);var h=s(f(d),1),p=f(d);l(p,-((p.getDay()-n+7)%7)),i(p);var g=f(h);l(g,(7-g.getDay()+n)%7),i(g,-1,!0);var m=u(),y=Math.round(v(g,p)/7);"fixed"==a("weekMode")&&(l(g,7*(6-y)),y=6),r.title=c(d,a("titleFormat")),r.start=d,r.end=h,r.visStart=p,r.visEnd=g,o(y,m,!0)}var r=this;r.render=n,K.call(r,t,e,"month");var a=r.opt,o=r.renderBasic,i=r.skipHiddenDays,u=r.getCellsPerWeek,c=e.formatDate}function J(t,e){function n(t,e){e&&l(t,7*e);var n=l(f(t),-((t.getDay()-a("firstDay")+7)%7)),c=l(f(n),7),d=f(n);i(d);var h=f(c);i(h,-1,!0);var v=s();r.start=n,r.end=c,r.visStart=d,r.visEnd=h,r.title=u(d,l(f(h),-1),a("titleFormat")),o(1,v,!1)}var r=this;r.render=n,K.call(r,t,e,"basicWeek");var a=r.opt,o=r.renderBasic,i=r.skipHiddenDays,s=r.getCellsPerWeek,u=e.formatDates}function X(t,e){function n(t,e){e&&l(t,e),i(t,0>e?-1:1);var n=f(t,!0),u=l(f(n),1);r.title=s(t,a("titleFormat")),r.start=r.visStart=n,r.end=r.visEnd=u,o(1,1,!1)}var r=this;r.render=n,K.call(r,t,e,"basicDay");var a=r.opt,o=r.renderBasic,i=r.skipHiddenDays,s=e.formatDate}function K(e,n,r){function a(t,e,n){ee=t,ne=e,re=n,o(),$||i(),s()}function o(){le=ve("theme")?"ui":"fc",ue=ve("columnFormat"),ce=ve("weekNumbers"),fe=ve("weekNumberTitle"),he="iso"!=ve("weekNumberCalculation")?"w":"W"}function i(){K=t("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(e)}function s(){var n=u();W&&W.remove(),W=t(n).appendTo(e),L=W.find("thead"),P=L.find(".fc-day-header"),$=W.find("tbody"),V=$.find("tr"),B=$.find(".fc-day"),Y=V.find("td:first-child"),J=V.eq(0).find(".fc-day > div"),X=V.eq(0).find(".fc-day-content > div"),q(L.add(L.find("tr"))),q(V),V.eq(0).addClass("fc-first"),V.filter(":last").addClass("fc-last"),B.each(function(e,n){var r=Me(Math.floor(e/ne),e%ne);pe("dayRender",A,r,t(n))}),y(B)}function u(){var t="<table class='fc-border-separate' style='width:100%' cellspacing='0'>"+c()+h()+"</table>";return t}function c(){var t,e,n=le+"-widget-header",r="";for(r+="<thead><tr>",ce&&(r+="<th class='fc-week-number "+n+"'>"+j(fe)+"</th>"),t=0;ne>t;t++)e=Me(0,t),r+="<th class='fc-day-header fc-"+ke[e.getDay()]+" "+n+"'>"+j(Se(e,ue))+"</th>";return r+="</tr></thead>"}function h(){var t,e,n,r=le+"-widget-content",a="";for(a+="<tbody>",t=0;ee>t;t++){for(a+="<tr class='fc-week'>",ce&&(n=Me(t,0),a+="<td class='fc-week-number "+r+"'><div>"+j(Se(n,he))+"</div></td>"),e=0;ne>e;e++)n=Me(t,e),a+=v(n);a+="</tr>"}return a+="</tbody>"}function v(t){var e=le+"-widget-content",n=A.start.getMonth(),r=d(new Date),a="",o=["fc-day","fc-"+ke[t.getDay()],e];return t.getMonth()!=n&&o.push("fc-other-month"),+t==+r?o.push("fc-today",le+"-state-highlight"):o.push(r>t?"fc-past":"fc-future"),a+="<td class='"+o.join(" ")+"' data-date='"+Se(t,"yyyy-MM-dd")+"'><div>",re&&(a+="<div class='fc-day-number'>"+t.getDate()+"</div>"),a+="<div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>"}function p(e){G=e;var n,r,a,o=G-L.height();"variable"==ve("weekMode")?n=r=Math.floor(o/(1==ee?2:6)):(n=Math.floor(o/ee),r=o-n*(ee-1)),Y.each(function(e,o){ee>e&&(a=t(o),a.find("> div").css("min-height",(e==ee-1?r:n)-R(a)))})}function g(t){Z=t,ie.clear(),se.clear(),te=0,ce&&(te=L.find("th.fc-week-number").outerWidth()),Q=Math.floor((Z-te)/ne),T(P.slice(0,-1),Q)}function y(t){t.click(w).mousedown(_e)}function w(e){if(!ve("selectable")){var n=m(t(this).data("date"));pe("dayClick",this,n,!0,e)}}function b(t,e,n){n&&ae.build();for(var r=Ee(t,e),a=0;r.length>a;a++){var o=r[a];y(D(o.row,o.leftCol,o.row,o.rightCol))}}function D(t,n,r,a){var o=ae.rect(t,n,r,a,e);return be(o,e)}function C(t){return f(t)}function _(t,e){b(t,l(f(e),1),!0)}function M(){Ce()}function E(t,e,n){var r=Te(t),a=B[r.row*ne+r.col];pe("dayClick",a,t,e,n)}function S(t,e){oe.start(function(t){Ce(),t&&D(t.row,t.col,t.row,t.col)},e)}function k(t,e,n){var r=oe.stop();if(Ce(),r){var a=Me(r);pe("drop",t,a,!0,e,n)}}function x(t){return f(t.start)}function H(t){return ie.left(t)}function F(t){return ie.right(t)}function z(t){return se.left(t)}function N(t){return se.right(t)}function O(t){return V.eq(t)}var A=this;A.renderBasic=a,A.setHeight=p,A.setWidth=g,A.renderDayOverlay=b,A.defaultSelectionEnd=C,A.renderSelection=_,A.clearSelection=M,A.reportDayClick=E,A.dragStart=S,A.dragStop=k,A.defaultEventEnd=x,A.getHoverListener=function(){return oe},A.colLeft=H,A.colRight=F,A.colContentLeft=z,A.colContentRight=N,A.getIsCellAllDay=function(){return!0},A.allDayRow=O,A.getRowCnt=function(){return ee},A.getColCnt=function(){return ne},A.getColWidth=function(){return Q},A.getDaySegmentContainer=function(){return K},de.call(A,e,n,r),me.call(A),ge.call(A),U.call(A);var W,L,P,$,V,B,Y,J,X,K,Z,G,Q,te,ee,ne,re,ae,oe,ie,se,le,ue,ce,fe,he,ve=A.opt,pe=A.trigger,be=A.renderOverlay,Ce=A.clearOverlays,_e=A.daySelectionMousedown,Me=A.cellToDate,Te=A.dateToCell,Ee=A.rangeToSegments,Se=n.formatDate;I(e.addClass("fc-grid")),ae=new ye(function(e,n){var r,a,o;P.each(function(e,i){r=t(i),a=r.offset().left,e&&(o[1]=a),o=[a],n[e]=o}),o[1]=a+r.outerWidth(),V.each(function(n,i){ee>n&&(r=t(i),a=r.offset().top,n&&(o[1]=a),o=[a],e[n]=o)}),o[1]=a+r.outerHeight()}),oe=new we(ae),ie=new De(function(t){return J.eq(t)}),se=new De(function(t){return X.eq(t)})}function U(){function t(t,e){n.renderDayEvents(t,e)}function e(){n.getDaySegmentContainer().empty()}var n=this;n.renderEvents=t,n.clearEvents=e,fe.call(n)}function Z(t,e){function n(t,e){e&&l(t,7*e);var n=l(f(t),-((t.getDay()-a("firstDay")+7)%7)),c=l(f(n),7),d=f(n);i(d);var h=f(c);i(h,-1,!0);var v=s();r.title=u(d,l(f(h),-1),a("titleFormat")),r.start=n,r.end=c,r.visStart=d,r.visEnd=h,o(v)}var r=this;r.render=n,Q.call(r,t,e,"agendaWeek");var a=r.opt,o=r.renderAgenda,i=r.skipHiddenDays,s=r.getCellsPerWeek,u=e.formatDates}function G(t,e){function n(t,e){e&&l(t,e),i(t,0>e?-1:1);var n=f(t,!0),u=l(f(n),1);r.title=s(t,a("titleFormat")),r.start=r.visStart=n,r.end=r.visEnd=u,o(1)}var r=this;r.render=n,Q.call(r,t,e,"agendaDay");var a=r.opt,o=r.renderAgenda,i=r.skipHiddenDays,s=e.formatDate}function Q(n,r,a){function o(t){Ne=t,i(),Q?u():s()}function i(){je=Xe("theme")?"ui":"fc",Ie=Xe("isRTL"),qe=y(Xe("minTime")),$e=y(Xe("maxTime")),Ve=Xe("columnFormat"),Be=Xe("weekNumbers"),Ye=Xe("weekNumberTitle"),Je="iso"!=Xe("weekNumberCalculation")?"w":"W",Re=Xe("snapMinutes")||Xe("slotMinutes")}function s(){var e,r,a,o,i,s=je+"-widget-header",l=je+"-widget-content",d=0==Xe("slotMinutes")%15;for(u(),ue=t("<div style='position:absolute;z-index:2;left:0;width:100%'/>").appendTo(n),Xe("allDaySlot")?(ce=t("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(ue),e="<table style='width:100%' class='fc-agenda-allday' cellspacing='0'><tr><th class='"+s+" fc-agenda-axis'>"+Xe("allDayText")+"</th><td><div class='fc-day-content'><div style='position:relative'/></div></td><th class='"+s+" fc-agenda-gutter'>&nbsp;</th></tr></table>",fe=t(e).appendTo(ue),he=fe.find("tr"),C(he.find("td")),ue.append("<div class='fc-agenda-divider "+s+"'><div class='fc-agenda-divider-inner'/></div>")):ce=t([]),ve=t("<div style='position:absolute;width:100%;overflow-x:hidden;overflow-y:auto'/>").appendTo(ue),pe=t("<div style='position:relative;width:100%;overflow:hidden'/>").appendTo(ve),be=t("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(pe),e="<table class='fc-agenda-slots' style='width:100%' cellspacing='0'><tbody>",r=h(),o=c(f(r),$e),c(r,qe),Oe=0,a=0;o>r;a++)i=r.getMinutes(),e+="<tr class='fc-slot"+a+" "+(i?"fc-minor":"")+"'><th class='fc-agenda-axis "+s+"'>"+(d&&i?"&nbsp;":on(r,Xe("axisFormat")))+"</th><td class='"+l+"'><div style='position:relative'>&nbsp;</div></td></tr>",c(r,Xe("slotMinutes")),Oe++;e+="</tbody></table>",Ce=t(e).appendTo(pe),_(Ce.find("td"))}function u(){var e=v();Q&&Q.remove(),Q=t(e).appendTo(n),ee=Q.find("thead"),ne=ee.find("th").slice(1,-1),re=Q.find("tbody"),ae=re.find("td").slice(0,-1),oe=ae.find("> div"),ie=ae.find(".fc-day-content > div"),se=ae.eq(0),le=oe.eq(0),q(ee.add(ee.find("tr"))),q(re.add(re.find("tr")))}function v(){var t="<table style='width:100%' class='fc-agenda-days fc-border-separate' cellspacing='0'>"+p()+g()+"</table>";return t}function p(){var t,e,n,r=je+"-widget-header",a="";for(a+="<thead><tr>",Be?(t=nn(0,0),e=on(t,Je),Ie?e+=Ye:e=Ye+e,a+="<th class='fc-agenda-axis fc-week-number "+r+"'>"+j(e)+"</th>"):a+="<th class='fc-agenda-axis "+r+"'>&nbsp;</th>",n=0;Ne>n;n++)t=nn(0,n),a+="<th class='fc-"+ke[t.getDay()]+" fc-col"+n+" "+r+"'>"+j(on(t,Ve))+"</th>";return a+="<th class='fc-agenda-gutter "+r+"'>&nbsp;</th></tr></thead>"}function g(){var t,e,n,r,a,o=je+"-widget-header",i=je+"-widget-content",s=d(new Date),l="";for(l+="<tbody><tr><th class='fc-agenda-axis "+o+"'>&nbsp;</th>",n="",e=0;Ne>e;e++)t=nn(0,e),a=["fc-col"+e,"fc-"+ke[t.getDay()],i],+t==+s?a.push(je+"-state-highlight","fc-today"):a.push(s>t?"fc-past":"fc-future"),r="<td class='"+a.join(" ")+"'><div><div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>",n+=r;return l+=n,l+="<td class='fc-agenda-gutter "+i+"'>&nbsp;</td></tr></tbody>"}function m(t){t===e&&(t=Te),Te=t,sn={};var n=re.position().top,r=ve.position().top,a=Math.min(t-n,Ce.height()+r+1);le.height(a-R(se)),ue.css("top",n),ve.height(a-r-1),He=Ce.find("tr:first").height()+1,Fe=Xe("slotMinutes")/Re,ze=He/Fe}function w(e){Me=e,Le.clear(),Pe.clear();var n=ee.find("th:first");fe&&(n=n.add(fe.find("th:first"))),n=n.add(Ce.find("th:first")),Ee=0,T(n.width("").each(function(e,n){Ee=Math.max(Ee,t(n).outerWidth())}),Ee);var r=Q.find(".fc-agenda-gutter");fe&&(r=r.add(fe.find("th.fc-agenda-gutter")));var a=ve[0].clientWidth;xe=ve.width()-a,xe?(T(r,xe),r.show().prev().removeClass("fc-last")):r.hide().prev().addClass("fc-last"),Se=Math.floor((a-Ee)/Ne),T(ne.slice(0,-1),Se)}function b(){function t(){ve.scrollTop(r)}var e=h(),n=f(e);n.setHours(Xe("firstHour"));var r=L(e,n)+1;t(),setTimeout(t,0)}function D(){b()}function C(t){t.click(M).mousedown(tn)}function _(t){t.click(M).mousedown(X)}function M(t){if(!Xe("selectable")){var e=Math.min(Ne-1,Math.floor((t.pageX-Q.offset().left-Ee)/Se)),n=nn(0,e),r=this.parentNode.className.match(/fc-slot(\d+)/);if(r){var a=parseInt(r[1])*Xe("slotMinutes"),o=Math.floor(a/60);n.setHours(o),n.setMinutes(a%60+qe),Ke("dayClick",ae[e],n,!1,t)}else Ke("dayClick",ae[e],n,!0,t)}}function S(t,e,n){n&&Ae.build();for(var r=an(t,e),a=0;r.length>a;a++){var o=r[a];C(k(o.row,o.leftCol,o.row,o.rightCol))}}function k(t,e,n,r){var a=Ae.rect(t,e,n,r,ue);return Ue(a,ue)}function x(t,e){for(var n=0;Ne>n;n++){var r=nn(0,n),a=l(f(r),1),o=new Date(Math.max(r,t)),i=new Date(Math.min(a,e));if(i>o){var s=Ae.rect(0,n,0,n,pe),u=L(r,o),c=L(r,i);s.top=u,s.height=c-u,_(Ue(s,pe))}}}function H(t){return Le.left(t)}function F(t){return Pe.left(t)}function z(t){return Le.right(t)}function N(t){return Pe.right(t)}function O(t){return Xe("allDaySlot")&&!t.row}function W(t){var e=nn(0,t.col),n=t.row;return Xe("allDaySlot")&&n--,n>=0&&c(e,qe+n*Re),e}function L(t,n){if(t=f(t,!0),c(f(t),qe)>n)return 0;if(n>=c(f(t),$e))return Ce.height();var r=Xe("slotMinutes"),a=60*n.getHours()+n.getMinutes()-qe,o=Math.floor(a/r),i=sn[o];return i===e&&(i=sn[o]=Ce.find("tr").eq(o).find("td div")[0].offsetTop),Math.max(0,Math.round(i-1+He*(a%r/r)))}function P(){return he}function $(t){var e=f(t.start);return t.allDay?e:c(e,Xe("defaultEventMinutes"))}function V(t,e){return e?f(t):c(f(t),Xe("slotMinutes"))}function B(t,e,n){n?Xe("allDaySlot")&&S(t,l(f(e),1),!0):Y(t,e)}function Y(e,n){var r=Xe("selectHelper");if(Ae.build(),r){var a=rn(e).col;if(a>=0&&Ne>a){var o=Ae.rect(0,a,0,a,pe),i=L(e,e),s=L(e,n);if(s>i){if(o.top=i,o.height=s-i,o.left+=2,o.width-=5,t.isFunction(r)){var l=r(e,n);l&&(o.position="absolute",_e=t(l).css(o).appendTo(pe))}else o.isStart=!0,o.isEnd=!0,_e=t(en({title:"",start:e,end:n,className:["fc-select-helper"],editable:!1},o)),_e.css("opacity",Xe("dragOpacity"));_e&&(_(_e),pe.append(_e),T(_e,o.width,!0),E(_e,o.height,!0))}}}else x(e,n)}function J(){Ze(),_e&&(_e.remove(),_e=null)}function X(e){if(1==e.which&&Xe("selectable")){Qe(e);var n;We.start(function(t,e){if(J(),t&&t.col==e.col&&!O(t)){var r=W(e),a=W(t);n=[r,c(f(r),Re),a,c(f(a),Re)].sort(A),Y(n[0],n[3])}else n=null},e),t(document).one("mouseup",function(t){We.stop(),n&&(+n[0]==+n[1]&&K(n[0],!1,t),Ge(n[0],n[3],!1,t))})}}function K(t,e,n){Ke("dayClick",ae[rn(t).col],t,e,n)}function U(t,e){We.start(function(t){if(Ze(),t)if(O(t))k(t.row,t.col,t.row,t.col);else{var e=W(t),n=c(f(e),Xe("defaultEventMinutes"));x(e,n)}},e)}function Z(t,e,n){var r=We.stop();Ze(),r&&Ke("drop",t,W(r),O(r),e,n)}var G=this;G.renderAgenda=o,G.setWidth=w,G.setHeight=m,G.afterRender=D,G.defaultEventEnd=$,G.timePosition=L,G.getIsCellAllDay=O,G.allDayRow=P,G.getCoordinateGrid=function(){return Ae},G.getHoverListener=function(){return We},G.colLeft=H,G.colRight=z,G.colContentLeft=F,G.colContentRight=N,G.getDaySegmentContainer=function(){return ce},G.getSlotSegmentContainer=function(){return be},G.getMinMinute=function(){return qe},G.getMaxMinute=function(){return $e},G.getSlotContainer=function(){return pe},G.getRowCnt=function(){return 1},G.getColCnt=function(){return Ne},G.getColWidth=function(){return Se},G.getSnapHeight=function(){return ze},G.getSnapMinutes=function(){return Re},G.defaultSelectionEnd=V,G.renderDayOverlay=S,G.renderSelection=B,G.clearSelection=J,G.reportDayClick=K,G.dragStart=U,G.dragStop=Z,de.call(G,n,r,a),me.call(G),ge.call(G),te.call(G);var Q,ee,ne,re,ae,oe,ie,se,le,ue,ce,fe,he,ve,pe,be,Ce,_e,Me,Te,Ee,Se,xe,He,Re,Fe,ze,Ne,Oe,Ae,We,Le,Pe,je,Ie,qe,$e,Ve,Be,Ye,Je,Xe=G.opt,Ke=G.trigger,Ue=G.renderOverlay,Ze=G.clearOverlays,Ge=G.reportSelection,Qe=G.unselect,tn=G.daySelectionMousedown,en=G.slotSegHtml,nn=G.cellToDate,rn=G.dateToCell,an=G.rangeToSegments,on=r.formatDate,sn={};I(n.addClass("fc-agenda")),Ae=new ye(function(e,n){function r(t){return Math.max(l,Math.min(u,t))}var a,o,i;ne.each(function(e,r){a=t(r),o=a.offset().left,e&&(i[1]=o),i=[o],n[e]=i}),i[1]=o+a.outerWidth(),Xe("allDaySlot")&&(a=he,o=a.offset().top,e[0]=[o,o+a.outerHeight()]);for(var s=pe.offset().top,l=ve.offset().top,u=l+ve.outerHeight(),c=0;Oe*Fe>c;c++)e.push([r(s+ze*c),r(s+ze*(c+1))])}),We=new we(Ae),Le=new De(function(t){return oe.eq(t)}),Pe=new De(function(t){return ie.eq(t)})}function te(){function n(t,e){var n,r=t.length,o=[],i=[];for(n=0;r>n;n++)t[n].allDay?o.push(t[n]):i.push(t[n]);y("allDaySlot")&&(te(o,e),k()),s(a(i),e)}function r(){x().empty(),H().empty()}function a(e){var n,r,a,s,l,u=I(),d=N(),h=z(),v=t.map(e,i),p=[];for(r=0;u>r;r++)for(n=P(0,r),c(n,d),l=o(e,v,n,c(f(n),h-d)),l=ee(l),a=0;l.length>a;a++)s=l[a],s.col=r,p.push(s);return p}function o(t,e,n,r){var a,o,i,s,l,u,c,d,h=[],v=t.length;for(a=0;v>a;a++)o=t[a],i=o.start,s=e[a],s>n&&r>i&&(n>i?(l=f(n),c=!1):(l=i,c=!0),s>r?(u=f(r),d=!1):(u=s,d=!0),h.push({event:o,start:l,end:u,isStart:c,isEnd:d}));return h.sort(ce)}function i(t){return t.end?f(t.end):c(f(t.start),y("defaultEventMinutes"))}function s(n,r){var a,o,i,s,l,c,f,h,v,p,g,m,b,D,C,_,T=n.length,E="",k=H(),x=y("isRTL");for(a=0;T>a;a++)o=n[a],i=o.event,s=O(o.start,o.start),l=O(o.start,o.end),c=W(o.col),f=L(o.col),h=f-c,f-=.025*h,h=f-c,v=h*(o.forwardCoord-o.backwardCoord),y("slotEventOverlap")&&(v=Math.max(2*(v-10),v)),x?(g=f-o.backwardCoord*h,p=g-v):(p=c+o.backwardCoord*h,g=p+v),p=Math.max(p,c),g=Math.min(g,f),v=g-p,o.top=s,o.left=p,o.outerWidth=v,o.outerHeight=l-s,E+=u(i,o);for(k[0].innerHTML=E,m=k.children(),a=0;T>a;a++)o=n[a],i=o.event,b=t(m[a]),D=w("eventRender",i,i,b),D===!1?b.remove():(D&&D!==!0&&(b.remove(),b=t(D).css({position:"absolute",top:o.top,left:o.left}).appendTo(k)),o.element=b,i._id===r?d(i,b,o):b[0]._fci=a,J(i,b));for(M(k,n,d),a=0;T>a;a++)o=n[a],(b=o.element)&&(o.vsides=R(b,!0),o.hsides=S(b,!0),C=b.find(".fc-event-title"),C.length&&(o.contentTop=C[0].offsetTop));for(a=0;T>a;a++)o=n[a],(b=o.element)&&(b[0].style.width=Math.max(0,o.outerWidth-o.hsides)+"px",_=Math.max(0,o.outerHeight-o.vsides),b[0].style.height=_+"px",i=o.event,o.contentTop!==e&&10>_-o.contentTop&&(b.find("div.fc-event-time").text(re(i.start,y("timeFormat"))+" - "+i.title),b.find("div.fc-event-title").remove()),w("eventAfterRender",i,i,b))}function u(t,e){var n="<",r=t.url,a=$(t,y),o=["fc-event","fc-event-vert"];return b(t)&&o.push("fc-event-draggable"),e.isStart&&o.push("fc-event-start"),e.isEnd&&o.push("fc-event-end"),o=o.concat(t.className),t.source&&(o=o.concat(t.source.className||[])),n+=r?"a href='"+j(t.url)+"'":"div",n+=" class='"+o.join(" ")+"' style='position:absolute;top:"+e.top+"px;left:"+e.left+"px;"+a+"'><div class='fc-event-inner'><div class='fc-event-time'>"+j(ae(t.start,t.end,y("timeFormat")))+"</div><div class='fc-event-title'>"+j(t.title||"")+"</div></div><div class='fc-event-bg'></div>",e.isEnd&&D(t)&&(n+="<div class='ui-resizable-handle ui-resizable-s'>=</div>"),n+="</"+(r?"a":"div")+">"}function d(t,e,n){var r=e.find("div.fc-event-time");b(t)&&p(t,e,r),n.isEnd&&D(t)&&g(t,e,r),T(t,e)}function h(t,e,n){function r(){u||(e.width(a).height("").draggable("option","grid",null),u=!0)}var a,o,i,s=n.isStart,u=!0,c=F(),d=q(),h=V(),p=B(),g=N();e.draggable({opacity:y("dragOpacity","month"),revertDuration:y("dragRevertDuration"),start:function(n,g){w("eventDragStart",e,t,n,g),K(t,e),a=e.width(),c.start(function(n,a){if(Q(),n){o=!1;var c=P(0,a.col),g=P(0,n.col);i=v(g,c),n.row?s?u&&(e.width(d-10),E(e,h*Math.round((t.end?(t.end-t.start)/Re:y("defaultEventMinutes"))/p)),e.draggable("option","grid",[d,1]),u=!1):o=!0:(G(l(f(t.start),i),l(C(t),i)),r()),o=o||u&&!i
}else r(),o=!0;e.draggable("option","revert",o)},n,"drag")},stop:function(n,a){if(c.stop(),Q(),w("eventDragStop",e,t,n,a),o)r(),e.css("filter",""),X(t,e);else{var s=0;u||(s=Math.round((e.offset().top-Y().offset().top)/h)*p+g-(60*t.start.getHours()+t.start.getMinutes())),U(this,t,i,s,u,n,a)}}})}function p(t,e,n){function r(){Q(),s&&(d?(n.hide(),e.draggable("option","grid",null),G(l(f(t.start),b),l(C(t),b))):(a(D),n.css("display",""),e.draggable("option","grid",[E,S])))}function a(e){var r,a=c(f(t.start),e);t.end&&(r=c(f(t.end),e)),n.text(ae(a,r,y("timeFormat")))}var o,i,s,u,d,h,p,g,b,D,_,M=m.getCoordinateGrid(),T=I(),E=q(),S=V(),k=B();e.draggable({scroll:!1,grid:[E,S],axis:1==T?"y":!1,opacity:y("dragOpacity"),revertDuration:y("dragRevertDuration"),start:function(n,r){w("eventDragStart",e,t,n,r),K(t,e),M.build(),o=e.position(),i=M.cell(n.pageX,n.pageY),s=u=!0,d=h=A(i),p=g=0,b=0,D=_=0},drag:function(t,n){var a=M.cell(t.pageX,t.pageY);if(s=!!a){if(d=A(a),p=Math.round((n.position.left-o.left)/E),p!=g){var l=P(0,i.col),c=i.col+p;c=Math.max(0,c),c=Math.min(T-1,c);var f=P(0,c);b=v(f,l)}d||(D=Math.round((n.position.top-o.top)/S)*k)}(s!=u||d!=h||p!=g||D!=_)&&(r(),u=s,h=d,g=p,_=D),e.draggable("option","revert",!s)},stop:function(n,a){Q(),w("eventDragStop",e,t,n,a),s&&(d||b||D)?U(this,t,b,d?0:D,d,n,a):(s=!0,d=!1,p=0,b=0,D=0,r(),e.css("filter",""),e.css(o),X(t,e))}})}function g(t,e,n){var r,a,o=V(),i=B();e.resizable({handles:{s:".ui-resizable-handle"},grid:o,start:function(n,o){r=a=0,K(t,e),w("eventResizeStart",this,t,n,o)},resize:function(s,l){r=Math.round((Math.max(o,e.height())-l.originalSize.height)/o),r!=a&&(n.text(ae(t.start,r||t.end?c(_(t),i*r):null,y("timeFormat"))),a=r)},stop:function(n,a){w("eventResizeStop",this,t,n,a),r?Z(this,t,0,i*r,n,a):X(t,e)}})}var m=this;m.renderEvents=n,m.clearEvents=r,m.slotSegHtml=u,fe.call(m);var y=m.opt,w=m.trigger,b=m.isEventDraggable,D=m.isEventResizable,_=m.eventEnd,T=m.eventElementHandlers,k=m.setHeight,x=m.getDaySegmentContainer,H=m.getSlotSegmentContainer,F=m.getHoverListener,z=m.getMaxMinute,N=m.getMinMinute,O=m.timePosition,A=m.getIsCellAllDay,W=m.colContentLeft,L=m.colContentRight,P=m.cellToDate,I=m.getColCnt,q=m.getColWidth,V=m.getSnapHeight,B=m.getSnapMinutes,Y=m.getSlotContainer,J=m.reportEventElement,X=m.showEvents,K=m.hideEvents,U=m.eventDrop,Z=m.eventResize,G=m.renderDayOverlay,Q=m.clearOverlays,te=m.renderDayEvents,ne=m.calendar,re=ne.formatDate,ae=ne.formatDates;m.draggableDayEvent=h}function ee(t){var e,n=ne(t),r=n[0];if(re(n),r){for(e=0;r.length>e;e++)ae(r[e]);for(e=0;r.length>e;e++)oe(r[e],0,0)}return ie(n)}function ne(t){var e,n,r,a=[];for(e=0;t.length>e;e++){for(n=t[e],r=0;a.length>r&&se(n,a[r]).length;r++);(a[r]||(a[r]=[])).push(n)}return a}function re(t){var e,n,r,a,o;for(e=0;t.length>e;e++)for(n=t[e],r=0;n.length>r;r++)for(a=n[r],a.forwardSegs=[],o=e+1;t.length>o;o++)se(a,t[o],a.forwardSegs)}function ae(t){var n,r,a=t.forwardSegs,o=0;if(t.forwardPressure===e){for(n=0;a.length>n;n++)r=a[n],ae(r),o=Math.max(o,1+r.forwardPressure);t.forwardPressure=o}}function oe(t,n,r){var a,o=t.forwardSegs;if(t.forwardCoord===e)for(o.length?(o.sort(ue),oe(o[0],n+1,r),t.forwardCoord=o[0].backwardCoord):t.forwardCoord=1,t.backwardCoord=t.forwardCoord-(t.forwardCoord-r)/(n+1),a=0;o.length>a;a++)oe(o[a],0,t.forwardCoord)}function ie(t){var e,n,r,a=[];for(e=0;t.length>e;e++)for(n=t[e],r=0;n.length>r;r++)a.push(n[r]);return a}function se(t,e,n){n=n||[];for(var r=0;e.length>r;r++)le(t,e[r])&&n.push(e[r]);return n}function le(t,e){return t.end>e.start&&t.start<e.end}function ue(t,e){return e.forwardPressure-t.forwardPressure||(t.backwardCoord||0)-(e.backwardCoord||0)||ce(t,e)}function ce(t,e){return t.start-e.start||e.end-e.start-(t.end-t.start)||(t.event.title||"").localeCompare(e.event.title)}function de(n,r,a){function o(e,n){var r=J[e];return t.isPlainObject(r)?P(r,n||a):r}function i(t,e){return r.trigger.apply(r,[t,e||L].concat(Array.prototype.slice.call(arguments,2),[L]))}function s(t){var e=t.source||{};return B(t.startEditable,e.startEditable,o("eventStartEditable"),t.editable,e.editable,o("editable"))&&!o("disableDragging")}function u(t){var e=t.source||{};return B(t.durationEditable,e.durationEditable,o("eventDurationEditable"),t.editable,e.editable,o("editable"))&&!o("disableResizing")}function d(t){$={};var e,n,r=t.length;for(e=0;r>e;e++)n=t[e],$[n._id]?$[n._id].push(n):$[n._id]=[n]}function h(){$={},V={},Y=[]}function p(t){return t.end?f(t.end):j(t)}function g(t,e){Y.push({event:t,element:e}),V[t._id]?V[t._id].push(e):V[t._id]=[e]}function m(){t.each(Y,function(t,e){L.trigger("eventDestroy",e.event,e.event,e.element)})}function y(t,n){n.click(function(r){return n.hasClass("ui-draggable-dragging")||n.hasClass("ui-resizable-resizing")?e:i("eventClick",this,t,r)}).hover(function(e){i("eventMouseover",this,t,e)},function(e){i("eventMouseout",this,t,e)})}function w(t,e){D(t,e,"show")}function b(t,e){D(t,e,"hide")}function D(t,e,n){var r,a=V[t._id],o=a.length;for(r=0;o>r;r++)e&&a[r][0]==e[0]||a[r][n]()}function C(t,e,n,r,a,o,s){var l=e.allDay,u=e._id;M($[u],n,r,a),i("eventDrop",t,e,n,r,a,function(){M($[u],-n,-r,l),q(u)},o,s),q(u)}function _(t,e,n,r,a,o){var s=e._id;T($[s],n,r),i("eventResize",t,e,n,r,function(){T($[s],-n,-r),q(s)},a,o),q(s)}function M(t,n,r,a){r=r||0;for(var o,i=t.length,s=0;i>s;s++)o=t[s],a!==e&&(o.allDay=a),c(l(o.start,n,!0),r),o.end&&(o.end=c(l(o.end,n,!0),r)),I(o,J)}function T(t,e,n){n=n||0;for(var r,a=t.length,o=0;a>o;o++)r=t[o],r.end=c(l(p(r),e,!0),n),I(r,J)}function E(t){return"object"==typeof t&&(t=t.getDay()),U[t]}function S(){return X}function k(t,e,n){for(e=e||1;U[(t.getDay()+(n?e:0)+7)%7];)l(t,e)}function x(){var t=H.apply(null,arguments),e=R(t),n=F(e);return n}function H(t,e){var n=L.getColCnt(),r=Q?-1:1,a=Q?n-1:0;"object"==typeof t&&(e=t.col,t=t.row);var o=t*n+(e*r+a);return o}function R(t){var e=L.visStart.getDay();return t+=Z[e],7*Math.floor(t/X)+G[(t%X+X)%X]-e}function F(t){var e=f(L.visStart);return l(e,t),e}function z(t){var e=N(t),n=O(e),r=A(n);return r}function N(t){return v(t,L.visStart)}function O(t){var e=L.visStart.getDay();return t+=e,Math.floor(t/7)*X+Z[(t%7+7)%7]-Z[e]}function A(t){var e=L.getColCnt(),n=Q?-1:1,r=Q?e-1:0,a=Math.floor(t/e),o=(t%e+e)%e*n+r;return{row:a,col:o}}function W(t,e){for(var n=L.getRowCnt(),r=L.getColCnt(),a=[],o=N(t),i=N(e),s=O(o),l=O(i)-1,u=0;n>u;u++){var c=u*r,d=c+r-1,f=Math.max(s,c),h=Math.min(l,d);if(h>=f){var v=A(f),p=A(h),g=[v.col,p.col].sort(),m=R(f)==o,y=R(h)+1==i;a.push({row:u,leftCol:g[0],rightCol:g[1],isStart:m,isEnd:y})}}return a}var L=this;L.element=n,L.calendar=r,L.name=a,L.opt=o,L.trigger=i,L.isEventDraggable=s,L.isEventResizable=u,L.setEventData=d,L.clearEventData=h,L.eventEnd=p,L.reportEventElement=g,L.triggerEventDestroy=m,L.eventElementHandlers=y,L.showEvents=w,L.hideEvents=b,L.eventDrop=C,L.eventResize=_;var j=L.defaultEventEnd,I=r.normalizeEvent,q=r.reportEventChange,$={},V={},Y=[],J=r.options;L.isHiddenDay=E,L.skipHiddenDays=k,L.getCellsPerWeek=S,L.dateToCell=z,L.dateToDayOffset=N,L.dayOffsetToCellOffset=O,L.cellOffsetToCell=A,L.cellToDate=x,L.cellToCellOffset=H,L.cellOffsetToDayOffset=R,L.dayOffsetToDate=F,L.rangeToSegments=W;var X,K=o("hiddenDays")||[],U=[],Z=[],G=[],Q=o("isRTL");!function(){o("weekends")===!1&&K.push(0,6);for(var e=0,n=0;7>e;e++)Z[e]=n,U[e]=-1!=t.inArray(e,K),U[e]||(G[n]=e,n++);if(X=n,!X)throw"invalid hiddenDays"}()}function fe(){function e(t,e){var n=r(t,!1,!0);ve(n,function(t,e){F(t.event,e)}),w(n,e),ve(n,function(t,e){k("eventAfterRender",t.event,t.event,e)})}function n(t,e,n){var a=r([t],!0,!1),o=[];return ve(a,function(t,r){t.row===e&&r.css("top",n),o.push(r[0])}),o}function r(e,n,r){var o,l,u=K(),f=n?t("<div/>"):u,h=a(e);return i(h),o=s(h),f[0].innerHTML=o,l=f.children(),n&&u.append(l),c(h,l),ve(h,function(t,e){t.hsides=S(e,!0)}),ve(h,function(t,e){e.width(Math.max(0,t.outerWidth-t.hsides))}),ve(h,function(t,e){t.outerHeight=e.outerHeight(!0)}),d(h,r),h}function a(t){for(var e=[],n=0;t.length>n;n++){var r=o(t[n]);e.push.apply(e,r)}return e}function o(t){for(var e=t.start,n=C(t),r=ee(e,n),a=0;r.length>a;a++)r[a].event=t;return r}function i(t){for(var e=E("isRTL"),n=0;t.length>n;n++){var r=t[n],a=(e?r.isEnd:r.isStart)?J:B,o=(e?r.isStart:r.isEnd)?X:Y,i=a(r.leftCol),s=o(r.rightCol);r.left=i,r.outerWidth=s-i}}function s(t){for(var e="",n=0;t.length>n;n++)e+=u(t[n]);return e}function u(t){var e="",n=E("isRTL"),r=t.event,a=r.url,o=["fc-event","fc-event-hori"];x(r)&&o.push("fc-event-draggable"),t.isStart&&o.push("fc-event-start"),t.isEnd&&o.push("fc-event-end"),o=o.concat(r.className),r.source&&(o=o.concat(r.source.className||[]));var i=$(r,E);return e+=a?"<a href='"+j(a)+"'":"<div",e+=" class='"+o.join(" ")+"' style='position:absolute;left:"+t.left+"px;"+i+"'><div class='fc-event-inner'>",!r.allDay&&t.isStart&&(e+="<span class='fc-event-time'>"+j(U(r.start,r.end,E("timeFormat")))+"</span>"),e+="<span class='fc-event-title'>"+j(r.title||"")+"</span></div>",t.isEnd&&H(r)&&(e+="<div class='ui-resizable-handle ui-resizable-"+(n?"w":"e")+"'>&nbsp;&nbsp;&nbsp;</div>"),e+="</"+(a?"a":"div")+">"}function c(e,n){for(var r=0;e.length>r;r++){var a=e[r],o=a.event,i=n.eq(r),s=k("eventRender",o,o,i);s===!1?i.remove():(s&&s!==!0&&(s=t(s).css({position:"absolute",left:a.left}),i.replaceWith(s),i=s),a.element=i)}}function d(t,e){var n=h(t),r=y(),a=[];if(e)for(var o=0;r.length>o;o++)r[o].height(n[o]);for(var o=0;r.length>o;o++)a.push(r[o].position().top);ve(t,function(t,e){e.css("top",a[t.row]+t.top)})}function h(t){for(var e=P(),n=q(),r=[],a=p(t),o=0;e>o;o++){for(var i=a[o],s=[],l=0;n>l;l++)s.push(0);for(var u=0;i.length>u;u++){var c=i[u];c.top=W(s.slice(c.leftCol,c.rightCol+1));for(var l=c.leftCol;c.rightCol>=l;l++)s[l]=c.top+c.outerHeight}r.push(W(s))}return r}function p(t){var e,n,r,a=P(),o=[];for(e=0;t.length>e;e++)n=t[e],r=n.row,n.element&&(o[r]?o[r].push(n):o[r]=[n]);for(r=0;a>r;r++)o[r]=g(o[r]||[]);return o}function g(t){for(var e=[],n=m(t),r=0;n.length>r;r++)e.push.apply(e,n[r]);return e}function m(t){t.sort(pe);for(var e=[],n=0;t.length>n;n++){for(var r=t[n],a=0;e.length>a&&he(r,e[a]);a++);e[a]?e[a].push(r):e[a]=[r]}return e}function y(){var t,e=P(),n=[];for(t=0;e>t;t++)n[t]=V(t).find("div.fc-day-content > div");return n}function w(t,e){var n=K();ve(t,function(t,n,r){var a=t.event;a._id===e?b(a,n,t):n[0]._fci=r}),M(n,t,b)}function b(t,e,n){x(t)&&T.draggableDayEvent(t,e,n),n.isEnd&&H(t)&&T.resizableDayEvent(t,e,n),z(t,e)}function D(t,e){var n,r=te();e.draggable({delay:50,opacity:E("dragOpacity"),revertDuration:E("dragRevertDuration"),start:function(a,o){k("eventDragStart",e,t,a,o),O(t,e),r.start(function(r,a,o,i){if(e.draggable("option","revert",!r||!o&&!i),G(),r){var s=ne(a),u=ne(r);n=v(u,s),Z(l(f(t.start),n),l(C(t),n))}else n=0},a,"drag")},stop:function(a,o){r.stop(),G(),k("eventDragStop",e,t,a,o),n?A(this,t,n,0,t.allDay,a,o):(e.css("filter",""),N(t,e))}})}function _(e,r,a){var o=E("isRTL"),i=o?"w":"e",s=r.find(".ui-resizable-"+i),u=!1;I(r),r.mousedown(function(t){t.preventDefault()}).click(function(t){u&&(t.preventDefault(),t.stopImmediatePropagation())}),s.mousedown(function(o){function s(n){k("eventResizeStop",this,e,n),t("body").css("cursor",""),c.stop(),G(),d&&L(this,e,d,0,n),setTimeout(function(){u=!1},0)}if(1==o.which){u=!0;var c=te();P(),q();var d,f,h=r.css("top"),v=t.extend({},e),p=ie(oe(e.start));Q(),t("body").css("cursor",i+"-resize").one("mouseup",s),k("eventResizeStart",this,e,o),c.start(function(r,o){if(r){var s=re(o),u=re(r);if(u=Math.max(u,p),d=ae(u)-ae(s)){v.end=l(R(e),d,!0);var c=f;f=n(v,a.row,h),f=t(f),f.find("*").css("cursor",i+"-resize"),c&&c.remove(),O(e)}else f&&(N(e),f.remove(),f=null);G(),Z(e.start,l(C(e),d))}},o)}})}var T=this;T.renderDayEvents=e,T.draggableDayEvent=D,T.resizableDayEvent=_;var E=T.opt,k=T.trigger,x=T.isEventDraggable,H=T.isEventResizable,R=T.eventEnd,F=T.reportEventElement,z=T.eventElementHandlers,N=T.showEvents,O=T.hideEvents,A=T.eventDrop,L=T.eventResize,P=T.getRowCnt,q=T.getColCnt;T.getColWidth;var V=T.allDayRow,B=T.colLeft,Y=T.colRight,J=T.colContentLeft,X=T.colContentRight;T.dateToCell;var K=T.getDaySegmentContainer,U=T.calendar.formatDates,Z=T.renderDayOverlay,G=T.clearOverlays,Q=T.clearSelection,te=T.getHoverListener,ee=T.rangeToSegments,ne=T.cellToDate,re=T.cellToCellOffset,ae=T.cellOffsetToDayOffset,oe=T.dateToDayOffset,ie=T.dayOffsetToCellOffset}function he(t,e){for(var n=0;e.length>n;n++){var r=e[n];if(r.leftCol<=t.rightCol&&r.rightCol>=t.leftCol)return!0}return!1}function ve(t,e){for(var n=0;t.length>n;n++){var r=t[n],a=r.element;a&&e(r,a,n)}}function pe(t,e){return e.rightCol-e.leftCol-(t.rightCol-t.leftCol)||e.event.allDay-t.event.allDay||t.event.start-e.event.start||(t.event.title||"").localeCompare(e.event.title)}function ge(){function e(t,e,a){n(),e||(e=l(t,a)),u(t,e,a),r(t,e,a)}function n(t){d&&(d=!1,c(),s("unselect",null,t))}function r(t,e,n,r){d=!0,s("select",null,t,e,n,r)}function a(e){var a=o.cellToDate,s=o.getIsCellAllDay,l=o.getHoverListener(),d=o.reportDayClick;if(1==e.which&&i("selectable")){n(e);var f;l.start(function(t,e){c(),t&&s(t)?(f=[a(e),a(t)].sort(A),u(f[0],f[1],!0)):f=null},e),t(document).one("mouseup",function(t){l.stop(),f&&(+f[0]==+f[1]&&d(f[0],!0,t),r(f[0],f[1],!0,t))})}}var o=this;o.select=e,o.unselect=n,o.reportSelection=r,o.daySelectionMousedown=a;var i=o.opt,s=o.trigger,l=o.defaultSelectionEnd,u=o.renderSelection,c=o.clearSelection,d=!1;i("selectable")&&i("unselectAuto")&&t(document).mousedown(function(e){var r=i("unselectCancel");r&&t(e.target).parents(r).length||n(e)})}function me(){function e(e,n){var r=o.shift();return r||(r=t("<div class='fc-cell-overlay' style='position:absolute;z-index:3'/>")),r[0].parentNode!=n[0]&&r.appendTo(n),a.push(r.css(e).show()),r}function n(){for(var t;t=a.shift();)o.push(t.hide().unbind())}var r=this;r.renderOverlay=e,r.clearOverlays=n;var a=[],o=[]}function ye(t){var e,n,r=this;r.build=function(){e=[],n=[],t(e,n)},r.cell=function(t,r){var a,o=e.length,i=n.length,s=-1,l=-1;for(a=0;o>a;a++)if(r>=e[a][0]&&e[a][1]>r){s=a;break}for(a=0;i>a;a++)if(t>=n[a][0]&&n[a][1]>t){l=a;break}return s>=0&&l>=0?{row:s,col:l}:null},r.rect=function(t,r,a,o,i){var s=i.offset();return{top:e[t][0]-s.top,left:n[r][0]-s.left,width:n[o][1]-n[r][0],height:e[a][1]-e[t][0]}}}function we(e){function n(t){be(t);var n=e.cell(t.pageX,t.pageY);(!n!=!i||n&&(n.row!=i.row||n.col!=i.col))&&(n?(o||(o=n),a(n,o,n.row-o.row,n.col-o.col)):a(n,o),i=n)}var r,a,o,i,s=this;s.start=function(s,l,u){a=s,o=i=null,e.build(),n(l),r=u||"mousemove",t(document).bind(r,n)},s.stop=function(){return t(document).unbind(r,n),i}}function be(t){t.pageX===e&&(t.pageX=t.originalEvent.pageX,t.pageY=t.originalEvent.pageY)}function De(t){function n(e){return a[e]=a[e]||t(e)}var r=this,a={},o={},i={};r.left=function(t){return o[t]=o[t]===e?n(t).position().left:o[t]},r.right=function(t){return i[t]=i[t]===e?r.left(t)+n(t).width():i[t]},r.clear=function(){a={},o={},i={}}}var Ce={defaultView:"month",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberCalculation:"iso",weekNumberTitle:"W",allDayDefault:!0,ignoreTimezone:!0,lazyFetching:!0,startParam:"start",endParam:"end",titleFormat:{month:"MMMM yyyy",week:"MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}",day:"dddd, MMM d, yyyy"},columnFormat:{month:"ddd",week:"ddd M/d",day:"dddd M/d"},timeFormat:{"":"h(:mm)t"},isRTL:!1,firstDay:0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],buttonText:{prev:"<span class='fc-text-arrow'>&lsaquo;</span>",next:"<span class='fc-text-arrow'>&rsaquo;</span>",prevYear:"<span class='fc-text-arrow'>&laquo;</span>",nextYear:"<span class='fc-text-arrow'>&raquo;</span>",today:"today",month:"month",week:"week",day:"day"},theme:!1,buttonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e"},unselectAuto:!0,dropAccept:"*",handleWindowResize:!0},_e={header:{left:"next,prev today",center:"",right:"title"},buttonText:{prev:"<span class='fc-text-arrow'>&rsaquo;</span>",next:"<span class='fc-text-arrow'>&lsaquo;</span>",prevYear:"<span class='fc-text-arrow'>&raquo;</span>",nextYear:"<span class='fc-text-arrow'>&laquo;</span>"},buttonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w"}},Me=t.fullCalendar={version:"1.6.4"},Te=Me.views={};t.fn.fullCalendar=function(n){if("string"==typeof n){var a,o=Array.prototype.slice.call(arguments,1);return this.each(function(){var r=t.data(this,"fullCalendar");if(r&&t.isFunction(r[n])){var i=r[n].apply(r,o);a===e&&(a=i),"destroy"==n&&t.removeData(this,"fullCalendar")}}),a!==e?a:this}n=n||{};var i=n.eventSources||[];return delete n.eventSources,n.events&&(i.push(n.events),delete n.events),n=t.extend(!0,{},Ce,n.isRTL||n.isRTL===e&&Ce.isRTL?_e:{},n),this.each(function(e,a){var o=t(a),s=new r(o,n,i);o.data("fullCalendar",s),s.render()}),this},Me.sourceNormalizers=[],Me.sourceFetchers=[];var Ee={dataType:"json",cache:!1},Se=1;Me.addDays=l,Me.cloneDate=f,Me.parseDate=g,Me.parseISO8601=m,Me.parseTime=y,Me.formatDate=w,Me.formatDates=b;var ke=["sun","mon","tue","wed","thu","fri","sat"],xe=864e5,He=36e5,Re=6e4,Fe={s:function(t){return t.getSeconds()},ss:function(t){return L(t.getSeconds())},m:function(t){return t.getMinutes()},mm:function(t){return L(t.getMinutes())},h:function(t){return t.getHours()%12||12},hh:function(t){return L(t.getHours()%12||12)},H:function(t){return t.getHours()},HH:function(t){return L(t.getHours())},d:function(t){return t.getDate()},dd:function(t){return L(t.getDate())},ddd:function(t,e){return e.dayNamesShort[t.getDay()]},dddd:function(t,e){return e.dayNames[t.getDay()]},M:function(t){return t.getMonth()+1},MM:function(t){return L(t.getMonth()+1)},MMM:function(t,e){return e.monthNamesShort[t.getMonth()]},MMMM:function(t,e){return e.monthNames[t.getMonth()]},yy:function(t){return(t.getFullYear()+"").substring(2)},yyyy:function(t){return t.getFullYear()},t:function(t){return 12>t.getHours()?"a":"p"},tt:function(t){return 12>t.getHours()?"am":"pm"},T:function(t){return 12>t.getHours()?"A":"P"},TT:function(t){return 12>t.getHours()?"AM":"PM"},u:function(t){return w(t,"yyyy-MM-dd'T'HH:mm:ss'Z'")},S:function(t){var e=t.getDate();return e>10&&20>e?"th":["st","nd","rd"][e%10-1]||"th"},w:function(t,e){return e.weekNumberCalculation(t)},W:function(t){return D(t)}};Me.dateFormatters=Fe,Me.applyAll=V,Te.month=Y,Te.basicWeek=J,Te.basicDay=X,n({weekMode:"fixed"}),Te.agendaWeek=Z,Te.agendaDay=G,n({allDaySlot:!0,allDayText:"all-day",firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:"h(:mm)tt",timeFormat:{agenda:"h:mm{ - h:mm}"},dragOpacity:{agenda:.5},minTime:0,maxTime:24,slotEventOverlap:!0})}(jQuery)}),function(){"use strict";var t={}.hasOwnProperty,e=function(e,n){function r(){this.constructor=e}for(var a in n)t.call(n,a)&&(e[a]=n[a]);return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e};define("event",["base","manager","models","lib/jquery-ui","lib/fullcalendar"],function(t,n,r){var a,o,i,s,l,u,c,d,f,h,v,p,g,m,y,w,b,D;return D=t.find,b=t.View,p=t.FrameView,m=t.InnerFrameView,v=t.FormDialogView,o=t.DurationConvertor,y=n.ManagerView,w=n.ProjectFilterView,a=r.Actions,h=r.Events,i=r.Event,c=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.collection=new h,n.prototype.initialize=function(t){var e;return n.__super__.initialize.call(this,t),e=this.collection,this.calendar=new l({el:"#event_calendar",parent:this,collection:e.fullCollection}),this.manager=new d({el:"#event_manager",parent:this,collection:e}),this.editor=new u({el:"#event_editor",parent:this}),e.load=function(t,e){return a.actions.load(function(e){return function(n,r){var a;return a=[],n.forEach(function(t){null!=t.event&&a.push(t.event),null!=t.tracking&&a.push(t.tracking)}),e.fullCollection.reset(a),e.trigger("loaded",e),"function"==typeof t?t(e,r):void 0}}(this),e),this},e.fetch=function(t){this.load(function(e,n){var r;null!=(r=t["error"===n?"error":"success"])&&r.call(this,this,null,t)},{expires:1e3})},this},n.prototype.open=function(t,e){switch(t){case"calendar":this.switchTo(this.calendar),this.calendar.goto(e);break;case"mgr":this.switchTo(this.manager);break;default:if(!t)throw new Error("open project with a name or id is needed");this.load(t)}return this},n.prototype.load=function(t){var e,n;return n=function(t){return function(e){return t.editor.popup(e.toJSON(),function(t,n){return"save"===t?e.save(n):void 0})}}(this),t instanceof i?n(t):(e=this.collection.get(t))?n(e):new i({id:t}).fetch({success:n,error:function(){var e;return e="Cannot find event with id "+t+" or net work problem",console.error(e),alert(e)}})},n.prototype.render=function(){return this.collection.load(),n.__super__.render.apply(this,arguments)},n}(p),u=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.goBackOnHidden="event/mgr",n.prototype.initialize=function(t){return n.__super__.initialize.call(this,t),this.$info=$(D(".info",this.form)),this.$form=$(this.form),this.btnView=D(".btn-view",this.el),this._dateToLocale=function(t){return t?new Date(t).toLocaleString():""},this._dateToString="text"===this.form.starts.type?this._dateToLocale:function(t){return t?new Date(t).toISOString():""},this._changed=this._changed.bind(this)},n.prototype._changed=function(t){var e,n,r,a,i,s,l,u,c;if(a=this.form,c=function(t){return t?new Date(t).getTime():null},l=c(a.starts.value.trim()),r=c(a.ends.value.trim()),n=o.parse(a.duration.value.trim()),l&&r&&n&&n!==r-l)switch(null!=t?null!=(u=t.currentTarget)?u.name:void 0:void 0){case"starts":case"duration":r=null;break;case"ends":n=null;break;default:console.warn("starts, ends and duration are not matched",l,r,n),l=r=n=null,i="Start Date, End Date and Duration are not matched"}return l?(a.starts=this._dateToString(l),r?r>l?n||(n=r-l):(i="Start Date must before End Date",console.warn("starts <= ends",l,r)):n&&(r=new Date(l+n),a.ends.value=this._dateToString(r))):r&&n&&(l=new Date(r-n),a.starts.value=this._dateToString(l)),i?(s=i,e="error"):(console.log("starts, ends, duration:",l,r,n),n&&(a.duration.value=o.stringify(n)),e="",s=[],s.push(l?"It will be started at "+this._dateToLocale(l)+".":"It will be started automatically when associated action been executed."),r?s.push("It will be ended at "+this._dateToLocale(r)+"."):(e="warning",s.push("It will be ended as soon as associated action finish execution.")),n&&s.push("Duration between starts and ends is "+a.duration.value+"."),s=s.join("<br/>")),this.$info.html(s).parents(".control-group").removeClass("success error").addClass(e),this},n.prototype.fill=function(t){var e;return t.starts&&(t.starts=new Date(t.starts),e=t.starts.getTime(),t.duration&&!t.ends?t.duration&&(t.ends=new Date(e+t.duration)):t.ends&&(t.ends=new Date(t.ends),null==t.duration&&(t.duration=t.ends.getTime()-e))),t.duration=t.duration?o.stringify(t.duration):"",t.starts=this._dateToString(t.starts),t.ends=this._dateToString(t.ends),console.log("fill event data",t),n.__super__.fill.call(this,t),this._changed(),this},n.prototype.read=function(){var t;return t=n.__super__.read.apply(this,arguments),t.starts&&(t.starts=new Date(t.starts)),t.starts||delete t.starts,t.ends&&(t.ends=new Date(t.ends)),t.ends||delete t.ends,t.duration=o.parse(t.duration),t.duration||delete t.duration,t},n.prototype.reset=function(){return this.$info.empty(),this.form.starts.readOnly=!1,this.form.ends.readOnly=!1,this.form.duration.readOnly=!1,this.btnView.href="",n.__super__.reset.apply(this,arguments)},n.prototype.popup=function(t,e){var r,a,o,i,s;switch(n.__super__.popup.call(this,t,e),a=["change","[name=starts],[name=ends],[name=duration]",this._changed],this.btnView.href="#event/calendar/"+t.id,(i=this.$form).off.apply(i,a),this.fill(t),r=this.form,o=(t.status||"").toUpperCase()){case"FINISHED":case"ERROR":case"STOPPED":r.starts.readOnly=!0,r.ends.readOnly=!0,r.duration.readOnly=!0;break;case"STARTED":case"TRACKED":case"PAUSED":r.starts.readOnly=!0,r.ends.readOnly=!1,r.duration.readOnly=!1;break;default:r.starts.readOnly=!1,r.ends.readOnly=!1,r.duration.readOnly=!1}return(s=this.$form).on.apply(s,a),this},n.prototype.save=function(){return this.data=this.read(),this.callback("save"),this.hide(!0),this},n}(v),l=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.collection=c.prototype.collection,n.prototype.initialize=function(t){return n.__super__.initialize.call(this,t),this.$sidebar=$(D(".sidebar-list",this.el)),this.calView=new g({parent:this,el:D("#calendar_view",this.el)}),this.listenTo(this.collection,"reset add remove change",function(t){return function(){return t.$el.is(":visible")?t.update():void 0}}(this)),this.listenTo(this.calView,"modify",this._modify.bind(this)),this.update=_.throttle(this.update.bind(this),500,{trailing:!1}),this},n.prototype._modify=function(t){var e;console.log("modify event",t.start,t.end,t),t.model&&t.start&&(t.end||(e=new Date(t.start),e.setHours(24,0,0,0),t.end=e,console.log("fix end",e)),t.model.save({starts:t.start,ends:t.end,duration:t.end.getTime()-t.start.getTime()}))},n.prototype.update=function(t){var e,n,r,a,o,s,l,u,c;for(null==t&&(t=this._curEvent),o=(null!=t?t.id:void 0)||t,console.log("cur",o),n=this.calView,r=this.collection,n.rendered||n.render(),a=[],s=[],r.forEach(function(e){var n,r;if(e.get("duration")||e.get("ends")){switch(r={id:e.id,url:"#event/"+e.id,title:e.get("name")||"(No Name)",model:e},e.has("starts")&&(r.start=new Date(e.get("starts"))),e.has("ends")&&(r.end=new Date(e.get("ends"))),r.allDay=null!=r.start&&null==r.end,n=e.status()){case"FINISHED":r.color="#ccc",r.editable=!1;break;case"IDLE":r.editable=!0,r.allDay&&(r.color="#006dcc");break;case"STARTED":case"TRACKED":r.color=null!=r.end?"#468847":"#faa732",r.startEditable=!1,r.durationEditable=!0;break;case"ERROR":r.color="#da4f49",r.editable=!1;break;default:r.editable=!1,console.warn("unsupported event status",n)}o&&o===e.id&&(t=e,r.className="active"),null!=r.start?a.push(r):s.push(r)}}),n.setEvents({events:a}),e=$(document.createDocumentFragment()),e.append('<li class="nav-header">Unscheduled Events</li>'),u=0,c=s.length;c>u;u++)l=s[u],e.append($("<li>").append($("<a>",{class:"external-event",text:l.title,href:"#event/"+l.id}))).data("event",l).draggable({helper:"clone",zIndex:999,revert:!0,revertDuration:0});return this.$sidebar.empty().append(e),t instanceof i&&t.has("starts")?n.goto(new Date(t.get("starts"))):this._curEvent=null,this},n.prototype.goto=function(t){return this.update(this._curEvent=t),this},n.prototype.render=function(){return this.calView.render(),n.__super__.render.apply(this,arguments)},n}(m),g=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.cfg={header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},handleWindowResize:!1,editable:!0,droppable:!0},n.prototype.initialize=function(t){var e,r,a;return n.__super__.initialize.call(this,t),this.collection=t.collection,e=this.$el,r=null!=this.fullCalendar?this.fullCalendar:this.fullCalendar=e.fullCalendar.bind(e),this.cfg.drop=function(t){return function(e,n,r){var a,o,i;a=$(r.target),i=a.data("event"),console.log("drop",e,n,i),i.start=e,null==i.end&&(i.model.has("duration")?(o=i.model.get("duration"),o>0&&(i.end=new Date(e.getTime()+o))):i.allDay=n),t.addEvent(i),a.remove(),t.trigger("modify",i)}}(this),this.cfg.eventResize=function(t){return function(e,n,r,a){return t.trigger("modify",e,a)}}(this),this.cfg.eventDrop=function(t){return function(e,n,r,a,o){return t.trigger("modify",e,o)}}(this),$(window).resize(this._resize=_.debounce(function(){return r("option","height",e.parents(".inner-frame").innerHeight())},150)),a=this.el.parentNode,e.on("mousewheel DOMMouseScroll",_.throttle(function(t){var e,n;e=t.shiftKey||t.ctrlKey,(e||!t.altKey&&!t.metaKey&&"month"===r("getView").name)&&(n=t.originalEvent.wheelDelta>0||t.originalEvent.detail<0,(e||n&&0===a.scrollTop||!n&&a.scrollTop>=a.scrollHeight-a.offsetHeight)&&(t.preventDefault(),r(n?"prev":"next"),a.scrollTop=0))},350,{trailing:!1})),this},n.prototype._view_map={month:"month",week:"agendaWeek",day:"agendaDay",agendaWeek:"agendaWeek",agendaDay:"agendaDay"},n.prototype.goto=function(t,e){return e&&this._view_map.hasOwnProperty(e)&&this.fullCalendar("changeView",this._view_map[e]),this.fullCalendar("gotoDate",t.getFullYear(),t.getMonth(),t.getDate()),this},n.prototype.remove=function(){return $(window).off("resize",this._resize),this.fullCalendar("destory"),this},n.prototype.render=function(){return this.$el.empty(),this.fullCalendar(this.cfg),this._resize(),n.__super__.render.apply(this,arguments)},n.prototype.setEvents=function(t){return this.fullCalendar("removeEvents"),console.log("set events",t),setTimeout(function(e){return function(){return e.fullCalendar("addEventSource",t)}}(this),100),this},n.prototype.addEvent=function(t){return this.fullCalendar("renderEvent",t,!0),this},n}(b),f=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.className="datetime-cell",n.prototype.render=function(){var t,e,n,r;return r=this._getDate("starts"),n=this._getDate("ends"),e=Number(this.model.get("duration"))||0,t=[],r&&(t.push(r.toLocaleString()),t.push("-"),n?(t.push(n.toLocaleString()),e||(e=n.getTime()-r.getTime())):t.push("Project ends")),e&&(null!=n&&r&&e!==n.getTime()-r.getTime()&&console.error("duration and starts/ends not matched",e,r,n),t.push("("+o.stringify(e)+")")),t=t.join(" "),this.el.title=this.el.textContent=t,this.el.dataset.container="#event_manager",this},n.prototype._getDate=function(t){var e,n;if(n=this.model.get(t)){try{e=new Date(n),isNaN(e.getTime())&&(e=null)}catch(_error){e=null}return null==e&&console.error("unsupported datetime",n),e}return null},n}(Backgrid.StringCell),s=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.render=function(){var t,e;return n.__super__.render.apply(this,arguments),e=this.model,t=e.get("duration"),e.get("duration")&&e.get("starts")||this._hide("view"),this},n}(Backgrid.ActionsCell),d=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.columns=["id","name:event","workflow","node_action","status",{name:"duration",label:"Schedule",cell:f,editable:!1},{name:"event",label:"",editable:!1,sortable:!1,cell:s}],n.prototype.initialize=function(t){var e;return n.__super__.initialize.call(this,t),this.collection=t.collection,e=this.collection.fullCollection,this.projectFilter=new w({el:D("ul.project-list",this.el),collection:e}),this.reload=_.debounce(this.reload.bind(this),100),this},n.prototype.reload=function(){return this.projectFilter.clear(),n.__super__.reload.apply(this,arguments)},n.prototype.render=function(){return n.__super__.render.apply(this,arguments),this.projectFilter.render(),this},n}(y),c})}.call(this);